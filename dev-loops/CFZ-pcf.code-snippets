{
	"Initialize PCF control project": {
		"scope": "powershell",
		"prefix": "CFZ01-init-pcf-control-project",
		"body": [
			"#",
			"# ╔══════════════════════════════════════════════════════════════════════╗",
			"# ║ CFZ01: Initialize a PCF control project                              ║",
			"# ╚══════════════════════════════════════════════════════════════════════╝",
			"#",
			"# Scaffolds a React-based PCF control, patches .pcfproj with DefaultProjectTypeGuid,",
			"# and adds the project into the solution for dotnet builds.",
			"#",
			"# ──────────────────────────────────────────────────────────────────────────────────────────",
			"#                                        Commands",
			"# ──────────────────────────────────────────────────────────────────────────────────────────",
			"",
			"pac pcf init `",
			"--namespace ${1:tom} `",
			"--name ${2:Calendar} `",
			"--template ${3:field} `",
			"--framework react `",
			"--run-npm-install `",
			"--outputDirectory \"src/Controls.${2}\"",
			"",
			"cd \"src/Controls.${2}\"",
			"# Add DefaultProjectTypeGuid so dotnet build recognizes the custom project type",
			"\\$pcfproj = Get-ChildItem -Path . -Filter *.pcfproj -File | Select-Object -First 1",
			"[xml]\\$xml = Get-Content \\$pcfproj.FullName -Raw",
			"\\$propertyGroup = \\$xml.Project.PropertyGroup | Select-Object -First 1",
			"if (-not \\$propertyGroup.DefaultProjectTypeGuid) {",
			"    \\$newElement = \\$xml.CreateElement('DefaultProjectTypeGuid', \\$xml.Project.NamespaceURI)",
			"    \\$newElement.InnerText = 'FAE04EC0-301F-11D3-BF4B-00C04F79EFBC'",
			"    \\$propertyGroup.AppendChild(\\$newElement) > \\$null",
			"    \\$xml.Save(\\$pcfproj.FullName)",
			"}",
			"",
			"cd ../..",
			"# Add the PCF project into the root solution (adjust path if your .sln lives elsewhere)",
			"dotnet sln add \"src/Controls.${2}/Controls.${2}.pcfproj\""
		]
	},
	"Create PCF solution and add control to package": {
		"scope": "powershell",
		"prefix": "CFZ02-init-pcf-solution-project",
		"body": [
			"#",
			"# ╔══════════════════════════════════════════════════════════════════════╗",
			"# ║ CFZ02: Create PCF solution and add control                           ║",
			"# ╚══════════════════════════════════════════════════════════════════════╝",
			"#",
			"# Creates a Dataverse solution to host PCF controls, links the control project,",
			"# and wires the solution into the package deployer project.",
			"#",
			"# ──────────────────────────────────────────────────────────────────────────────────────────",
			"#                                        Commands",
			"# ──────────────────────────────────────────────────────────────────────────────────────────",
			"",
			"pac solution init `",
			"--publisher-name ${1:tomas} `",
			"--publisher-prefix ${2:tom} `",
			"--outputDirectory \"src/Solutions.Controls\"",
			"",
			"cd \"src/Solutions.Controls\"",
			"# Add the solution project to your .sln so it participates in builds",
			"dotnet sln add \"src/Solutions.Controls/Solutions.Controls.csproj\"",
			"",
			"# Link the PCF control project into the solution",
			"pac solution add-reference --path ../Controls.${3:Calendar}",
			"",
			"cd ../Packages.Main",
			"# Add the Controls solution into the package deployer project",
			"dotnet add \"./Packages.Main.csproj\" reference \"../Solutions.Controls/Solutions.Controls.csproj\"",
			"cd ../.."
		]
	},
	"Upgrade React dependencies for PCF control": {
		"scope": "powershell",
		"prefix": "CFZ03-upgrade-react-install-calendar",
		"body": [
			"#",
			"# ╔══════════════════════════════════════════════════════════════════════╗",
			"# ║ CFZ03: Upgrade React and install calendar deps                       ║",
			"# ╚══════════════════════════════════════════════════════════════════════╝",
			"#",
			"# Aligns React to v17 for PCF and installs react-big-calendar + moment typings.",
			"# Also enforces esModuleInterop in tsconfig for default imports.",
			"#",
			"# ______________________________________________________________________",
			"#                                 Commands",	
			"# ______________________________________________________________________",
			"",
			"cd \"src/Controls.${1:Calendar}\"",
			"npm install react@17 react-dom@17 @types/react@17 @types/react-dom@17",
			"npm install react-big-calendar moment",
			"npm install --save-dev @types/react-big-calendar",
			"",
			"# Enable esModuleInterop in tsconfig.json so default imports work",
			"\\$tsConfigPath = \"tsconfig.json\"",
			"\\$tsConfig = Get-Content -Path \\$tsConfigPath -Raw | ConvertFrom-Json",
			"if (-not \\$tsConfig.compilerOptions) { \\$tsConfig | Add-Member -Name compilerOptions -MemberType NoteProperty -Value (@{}) }",
			"\\$tsConfig.compilerOptions.esModuleInterop = \\$true",
			"\\$tsConfig | ConvertTo-Json -Depth 10 | Set-Content -Path \\$tsConfigPath -Encoding UTF8",
			"",
			"cd ../.."
		]
	},
	"Calendar React component for PCF": {
		"scope": "typescript,typescriptreact",
		"prefix": "CFZ04-calendar-react-component",
		"body": [
			"//",
			"// ╔══════════════════════════════════════════════════════════════════════╗",
			"// ║ CFZ04: Calendar React component for PCF control                      ║",
			"// ╚══════════════════════════════════════════════════════════════════════╝",
			"//",
			"// Ready-to-use React Big Calendar component wired for PCF usage.",
			"// Includes default events and accepts overrides via props.",
			"//",
			"// ______________________________________________________________________",
			"//                                 Commands",
			"// ______________________________________________________________________",
			"import * as React from 'react';",
			"import { Calendar, momentLocalizer, Views } from 'react-big-calendar';",
			"import moment from 'moment';",
			"import 'react-big-calendar/lib/css/react-big-calendar.css';",
			"",
			"export interface CalendarEvent {",
			"\tid: number;",
			"\ttitle: string;",
			"\tstart: Date;",
			"\tend: Date;",
			"}",
			"",
			"export interface ICalendarComponentProps {",
			"\tname?: string;",
			"\tevents?: CalendarEvent[];",
			"}",
			"",
			"const localizer = momentLocalizer(moment);",
			"",
			"const addHours = (hours: number) => {",
			"\tconst date = new Date();",
			"\tdate.setMinutes(0, 0, 0);",
			"\tdate.setHours(date.getHours() + hours);",
			"\treturn date;",
			"};",
			"",
			"const addDaysAtHour = (days: number, hour: number) => {",
			"\tconst date = new Date();",
			"\tdate.setHours(hour, 0, 0, 0);",
			"\tdate.setDate(date.getDate() + days);",
			"\treturn date;",
			"};",
			"",
			"const defaultEvents: CalendarEvent[] = [",
			"\t{",
			"\t\tid: 0,",
			"\t\ttitle: 'Team Meeting',",
			"\t\tstart: addHours(1),",
			"\t\tend: addHours(2)",
			"\t},",
			"\t{",
			"\t\tid: 1,",
			"\t\ttitle: 'Project Review',",
			"\t\tstart: addDaysAtHour(1, 10),",
			"\t\tend: addDaysAtHour(1, 11)",
			"\t},",
			"\t{",
			"\t\tid: 2,",
			"\t\ttitle: 'Client Call',",
			"\t\tstart: addDaysAtHour(2, 14),",
			"\t\tend: addDaysAtHour(2, 15)",
			"\t}",
			"];",
			"",
			"export const CalendarComponent: React.FC<ICalendarComponentProps> = ({ name, events = defaultEvents }) => {",
			"\treturn (",
			"\t\t<div style={{ height: '100%', minHeight: 400 }}>",
			"\t\t\t<Calendar",
			"\t\t\t\tlocalizer={localizer}",
			"\t\t\t\tevents={events}",
			"\t\t\t\tstartAccessor=\"start\"",
			"\t\t\t\tendAccessor=\"end\"",
			"\t\t\t\tdefaultView={Views.WEEK}",
			"\t\t\t\tstyle={{ height: '100%' }}",
			"\t\t\t\ttitleAccessor={(event) => event.title}",
			"\t\t\t/>",
			"\t\t</div>",
			"\t);",
			"};"
		]
	},
	"Build and import Controls solution to Dataverse": {
		"scope": "powershell",
		"prefix": "CFZ05-import-solution-to-dev-env",
		"body": [
			"#",
			"# ╔══════════════════════════════════════════════════════════════════════╗",
			"# ║ CFZ05: Build and import the Controls solution to Dataverse           ║",
			"# ╚══════════════════════════════════════════════════════════════════════╝",
			"#",
			"# Builds the PCF project, rebuilds the solution, and imports it into the current Dataverse environment.",
			"# Use after local changes to push PCF updates into Dataverse via solution import.",
			"#",
			"# ──────────────────────────────────────────────────────────────────────────────────────────",
			"#                                        Commands",
			"# ──────────────────────────────────────────────────────────────────────────────────────────",
			"",
			"cd \"src/Controls.${1:Calendar}\"",
			"npm run build",
			"cd ../..",
			"",
			"dotnet build",
			"",
			"cd \"src/Solutions.Controls\"",
			"pac solution import",
			"cd ../.."
		]
	},
	"Bump PCF version, push control, publish": {
		"scope": "powershell",
		"prefix": "CFZ06-push-pcf",
		"body": [
			"#",
			"# ╔══════════════════════════════════════════════════════════════════════╗",
			"# ║ CFZ06: Bump PCF version, push, publish                              ║",
			"# ╚══════════════════════════════════════════════════════════════════════╝",
			"#",
			"# Increments the control version, builds, pushes to Dataverse, and publishes customizations.",
			"# Ideal for quick iterations when testing the control in an environment.",
			"#",
			"# ──────────────────────────────────────────────────────────────────────────────────────────",
			"#                                        Commands",
			"# ──────────────────────────────────────────────────────────────────────────────────────────",
			"",
			"cd \"src/Controls.${1:Calendar}\"",
			"pac pcf version --patchversion ${2:1}",
			"npm run build",
			"pac pcf push --publisher-prefix ${3:tom}",
			"pac solution publish",
			"cd ../.."
		]
	},
	"Catalog commands (submit/install package)": {
		"scope": "powershell",
		"prefix": "CFZ07-catalog",
		"body": [
			"#",
			"# ╔══════════════════════════════════════════════════════════════════════╗",
			"# ║ CFZ07: Power Platform Catalog commands                              ║",
			"# ╚══════════════════════════════════════════════════════════════════════╝",
			"#",
			"# Submit a package to the catalog and install it into a target environment.",
			"# Useful for distributing packaged solutions across environments.",
			"#",
			"# ──────────────────────────────────────────────────────────────────────────────────────────",
			"#                                        Commands",
			"# ──────────────────────────────────────────────────────────────────────────────────────────",
			"",
			"pac admin list --application ${1:83a35943-cb41-4266-b7d2-81d60f383695}",
			"",
			"pac application install `",
			"--application-name ${2:mspcat_CatalogManager} `",
			"--environment \\$devEnvUrl",
			"",
			"pac catalog submit `",
			"--path ${3:./src/Packages.Main/bin/Release/Packages.Main.1.0.0.pdpkg.zip} `",
			"--package-zip ${3:./src/Packages.Main/bin/Release/Packages.Main.1.0.0.pdpkg.zip} `",
			"--environment \\$devEnvUrl `",
			"--poll-status",
			"",
			"pac catalog install `",
			"--catalog-item-id ${4:catalog-item-guid} `",
			"--target-env \\$uatEnvUrl `",
			"--environment \\$devEnvUrl `",
			"--poll-status"
		]
	}
}
