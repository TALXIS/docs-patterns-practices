{
    "Initialize a new PCF control project": {
		"scope": "powershell",
		"prefix": "CFF01-init-pcf-control-project",
		"body": [
			"# CFF01",
			"# Initialize a new PCF control project",
			"pac pcf init `",
			"--namespace tom `",
			"--name Calendar `",
			"--template field `",
			"--framework react `",
			"--run-npm-install `",
			"--outputDirectory \"src/Controls.Calendar\"",
			"",
			"cd \"src/Controls.Calendar\"",
			"# Add the missing project type ID to the .pcfproj to make dotnet accept the custom project type",
			"\\$csproj = Get-ChildItem -Path . -Filter *.pcfproj | Select-Object -First 1; [xml]\\$xml = Get-Content \\$csproj.FullName -Raw; \\$propertyGroup = \\$xml.Project.PropertyGroup | Select-Object -First 1; \\$newElement = \\$xml.CreateElement('DefaultProjectTypeGuid', \\$xml.Project.NamespaceURI); \\$newElement.InnerText = 'FAE04EC0-301F-11D3-BF4B-00C04F79EFBC'; \\$propertyGroup.AppendChild(\\$newElement) > \\$null; \\$xml.Save(\\$csproj.FullName)",
			"",
			"cd ../..",
			"dotnet sln add \"src/Controls.Calendar/Controls.Calendar.pcfproj\""
		]
	},
	"Initialize a new solution for PCF controls and add the control to it": {
		"scope": "powershell",
		"prefix": "CFF02-init-pcf-solution-project",
		"body": [
			"# CFF02",
			"# Initialize a new solution for PCF controls",
			"pac solution init --publisher-name tomas --publisher-prefix tom --outputDirectory \"Solutions.Controls\"",
			"cd \"Solutions.Controls\"",
			"",
			"${1:CFA06-rename-src-folder-remove-gitignore}",
			"",
			"${2:CFA07-patch-csproj}",
			"",
			"${3:CFA08-switch-type-sanitize-solution-name}",
			"",
			"# Add the project to the previously created Visual Studio solution",
			"dotnet sln ../../ add Solutions.Controls.cdsproj",
			"",
			"# Add the control to the solution",
			"pac solution add-reference --path ../Controls.Calendar",
			"# Add the new Controls solution to the package",
			"cd ..",
			"cd Packages.Main",
			"pac package add-reference --path \"../Solutions.Controls/\"",
			"",
			"cd ../.."
		]
	},
	"Upgrade React and install React Big Calendar": {
		"scope": "powershell",
		"prefix": "CFF03-upgrade-react-install-calendar",
		"body": [
			"# CFF03",
			"# Upgrade React and install React Big Calendar",
			"cd \"src/Controls.Calendar\"",
			"npm install react@17",
			"npm install react-dom@17",
			"npm install @types/react@17",
			"npm install @types/react-dom@17",
			"npm install react-big-calendar",
			"npm install moment",
			"npm i --save-dev @types/react-big-calendar",
			"",
			"# Enable esModuleInterop in tsconfig.json",
			"# tsconfig.json > compilerOptions > \"esModuleInterop\": true",
			"",
			"cd ../.."
		]
	},
	"Calendar React component": {
		"scope": "typescript,typescriptreact",
		"prefix": "CFF04-calendar-react-component",
		"body": [
			"// CFF04",
			"import * as React from 'react';",
			"import { Calendar, momentLocalizer, Views } from \"react-big-calendar\";",
			"import \"react-big-calendar/lib/css/react-big-calendar.css\";",
			"import moment from 'moment';",
			"",
			"export interface ICalendarComponentProps {",
			"\tname?: string;",
			"}",
			"",
			"const localizer = momentLocalizer(moment);",
			"",
			"// Sample events data for the current week",
			"const events = [",
			"\t{",
			"\t\tid: 0,",
			"\t\ttitle: 'Team Meeting',",
			"\t\tstart: new Date(new Date().setHours(new Date().getHours() + 1)),",
			"\t\tend: new Date(new Date().setHours(new Date().getHours() + 2))",
			"\t},",
			"\t{",
			"\t\tid: 1,",
			"\t\ttitle: 'Project Review',",
			"\t\tstart: new Date(new Date().setDate(new Date().getDate() + 1)),",
			"\t\tend: new Date(new Date().setDate(new Date().getDate() + 1)).setHours(new Date().getHours() + 1)",
			"\t},",
			"\t{",
			"\t\tid: 2,",
			"\t\ttitle: 'Client Call',",
			"\t\tstart: new Date(new Date().setDate(new Date().getDate() + 2)),",
			"\t\tend: new Date(new Date().setDate(new Date().getDate() + 2)).setHours(new Date().getHours() + 1)",
			"\t}",
			"];",
			"",
			"export class CalendarComponent extends React.Component<ICalendarComponentProps> {",
			"\tpublic render(): React.ReactNode {",
			"\t\treturn (",
			"\t\t\t<Calendar",
			"\t\t\tlocalizer={localizer}",
			"\t\t\tevents={events}",
			"\t\t\tstartAccessor=\"start\"",
			"\t\t\tendAccessor=\"end\"",
			"\t\t\tstyle={{ height: \"100%\" }}",
			"\t\t\tdefaultView={Views.WEEK}",
			"\t\t/>",
			"\t\t)",
			"\t}",
			"}"
		]
	},
	"Import the Controls solution to your Dataverse dev environment": {
		"scope": "powershell",
		"prefix": "CFF06-import-solution-to-dev-env",
		"body": [
			"# CFF06",
			"# Build the whole repository",
			"dotnet build",
			"",
			"# Import the locally built solutions to Dataverse so we can make modifications in the Power Apps Maker",
			"cd \"./src/Solutions.Controls/\"",
			"pac solution import",
			"cd ../.."
		]
	},
	"Bump the PCF version, push the control to the environment and publish it": {
		"scope": "powershell",
		"prefix": "CFF06-push-pcf",
		"body": [
			"# CFF06",
			"# Bump the PCF version, push the control to the environment and publish it",
			"pac pcf version --patchversion ${1:1}",
			"pac pcf push --publisher-prefix ${2:tom}",
			"pac solution publish"
		]
	}
}